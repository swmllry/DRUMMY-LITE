{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BulkWriteOperation = void 0;\n\nconst operation_1 = require(\"./operation\");\n/** @internal */\n\n\nclass BulkWriteOperation extends operation_1.AbstractOperation {\n  constructor(collection, operations, options) {\n    super(options);\n    this.options = options;\n    this.collection = collection;\n    this.operations = operations;\n  }\n\n  execute(server, session, callback) {\n    const coll = this.collection;\n    const operations = this.operations;\n    const options = { ...this.options,\n      ...this.bsonOptions,\n      readPreference: this.readPreference\n    }; // Create the bulk operation\n\n    const bulk = options.ordered === false ? coll.initializeUnorderedBulkOp(options) : coll.initializeOrderedBulkOp(options); // for each op go through and add to the bulk\n\n    try {\n      for (let i = 0; i < operations.length; i++) {\n        bulk.raw(operations[i]);\n      }\n    } catch (err) {\n      return callback(err);\n    } // Execute the bulk\n\n\n    bulk.execute({ ...options,\n      session\n    }, (err, r) => {\n      // We have connection level error\n      if (!r && err) {\n        return callback(err);\n      } // Return the results\n\n\n      callback(undefined, r);\n    });\n  }\n\n}\n\nexports.BulkWriteOperation = BulkWriteOperation;\n(0, operation_1.defineAspects)(BulkWriteOperation, [operation_1.Aspect.WRITE_OPERATION]);","map":{"version":3,"sources":["../../src/operations/bulk_write.ts"],"names":[],"mappings":";;;;;;;AAUA,MAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;AAEA;;;AACA,MAAa,kBAAb,SAAwC,WAAA,CAAA,iBAAxC,CAA0E;EAKxE,WAAA,CACE,UADF,EAEE,UAFF,EAGE,OAHF,EAG2B;IAEzB,MAAM,OAAN;IACA,KAAK,OAAL,GAAe,OAAf;IACA,KAAK,UAAL,GAAkB,UAAlB;IACA,KAAK,UAAL,GAAkB,UAAlB;EACD;;EAEQ,OAAO,CACd,MADc,EAEd,OAFc,EAGd,QAHc,EAGqB;IAEnC,MAAM,IAAI,GAAG,KAAK,UAAlB;IACA,MAAM,UAAU,GAAG,KAAK,UAAxB;IACA,MAAM,OAAO,GAAG,EAAE,GAAG,KAAK,OAAV;MAAmB,GAAG,KAAK,WAA3B;MAAwC,cAAc,EAAE,KAAK;IAA7D,CAAhB,CAJmC,CAMnC;;IACA,MAAM,IAAI,GACR,OAAO,CAAC,OAAR,KAAoB,KAApB,GACI,IAAI,CAAC,yBAAL,CAA+B,OAA/B,CADJ,GAEI,IAAI,CAAC,uBAAL,CAA6B,OAA7B,CAHN,CAPmC,CAYnC;;IACA,IAAI;MACF,KAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,UAAU,CAAC,MAA/B,EAAuC,CAAC,EAAxC,EAA4C;QAC1C,IAAI,CAAC,GAAL,CAAS,UAAU,CAAC,CAAD,CAAnB;MACD;IACF,CAJD,CAIE,OAAO,GAAP,EAAY;MACZ,OAAO,QAAQ,CAAC,GAAD,CAAf;IACD,CAnBkC,CAqBnC;;;IACA,IAAI,CAAC,OAAL,CAAa,EAAE,GAAG,OAAL;MAAc;IAAd,CAAb,EAAsC,CAAC,GAAD,EAAM,CAAN,KAAW;MAC/C;MACA,IAAI,CAAC,CAAD,IAAM,GAAV,EAAe;QACb,OAAO,QAAQ,CAAC,GAAD,CAAf;MACD,CAJ8C,CAM/C;;;MACA,QAAQ,CAAC,SAAD,EAAY,CAAZ,CAAR;IACD,CARD;EASD;;AAlDuE;;AAA1E,OAAA,CAAA,kBAAA,GAAA,kBAAA;AAqDA,CAAA,GAAA,WAAA,CAAA,aAAA,EAAc,kBAAd,EAAkC,CAAC,WAAA,CAAA,MAAA,CAAO,eAAR,CAAlC","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BulkWriteOperation = void 0;\nconst operation_1 = require(\"./operation\");\n/** @internal */\nclass BulkWriteOperation extends operation_1.AbstractOperation {\n    constructor(collection, operations, options) {\n        super(options);\n        this.options = options;\n        this.collection = collection;\n        this.operations = operations;\n    }\n    execute(server, session, callback) {\n        const coll = this.collection;\n        const operations = this.operations;\n        const options = { ...this.options, ...this.bsonOptions, readPreference: this.readPreference };\n        // Create the bulk operation\n        const bulk = options.ordered === false\n            ? coll.initializeUnorderedBulkOp(options)\n            : coll.initializeOrderedBulkOp(options);\n        // for each op go through and add to the bulk\n        try {\n            for (let i = 0; i < operations.length; i++) {\n                bulk.raw(operations[i]);\n            }\n        }\n        catch (err) {\n            return callback(err);\n        }\n        // Execute the bulk\n        bulk.execute({ ...options, session }, (err, r) => {\n            // We have connection level error\n            if (!r && err) {\n                return callback(err);\n            }\n            // Return the results\n            callback(undefined, r);\n        });\n    }\n}\nexports.BulkWriteOperation = BulkWriteOperation;\n(0, operation_1.defineAspects)(BulkWriteOperation, [operation_1.Aspect.WRITE_OPERATION]);\n//# sourceMappingURL=bulk_write.js.map"]},"metadata":{},"sourceType":"script"}